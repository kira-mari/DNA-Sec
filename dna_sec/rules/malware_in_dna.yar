rule shellcode_x86_common {
    meta:
        description = "Détection de shellcode x86 courant dans des données binaires"
        author = "DNA-Sec"
    strings:
        $sc1 = { 31 C0 } // xor eax, eax
        $sc2 = { 31 DB } // xor ebx, ebx
        $sc3 = { 31 C9 } // xor ecx, ecx
        $sc4 = { 31 D2 } // xor edx, edx
        $sc5 = { 6A 0B } // push 0B
        $sc6 = { 58 }    // pop eax
        $sc7 = { CD 80 } // int 0x80
        $sc8 = { FF E4 } // jmp esp
    condition:
        any of them
}

rule executable_strings {
    meta:
        description = "Chaînes exécutables typiques"
    strings:
        $s1 = "/bin/sh" ascii
        $s2 = "/bin/bash" ascii
        $s3 = "cmd.exe" ascii
        $s4 = "powershell" ascii
        $s5 = "exec(" ascii
        $s6 = "system(" ascii
        $s7 = "eval(" ascii
    condition:
        any of them
}

rule binary_headers {
    meta:
        description = "Signatures de formats binaires"
    strings:
        $elf = { 7F 45 4C 46 } // ELF
        $pe = { 4D 5A }        // PE (DOS header)
        $zip = { 50 4B 03 04 } // ZIP
    condition:
        any of them
}